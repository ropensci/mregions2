<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Get a data product — mrp_get • mregions2</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Get a data product — mrp_get"><meta name="description" content="Get a data product"><meta property="og:description" content="Get a data product"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mregions2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/mregions2.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/mregions2-rdf.html">mregions2 as RDF</a></li>
    <li><a class="dropdown-item" href="../articles/mrp_ontology.html">Marine Regions Data Products Ontology</a></li>
    <li><a class="dropdown-item" href="../articles/why_mregions2.html">Why mregions and mregions2?</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ropensci/mregions2/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Get a data product</h1>
      <small class="dont-index">Source: <a href="https://github.com/ropensci/mregions2/blob/main/R/08_mrp_get.R" class="external-link"><code>R/08_mrp_get.R</code></a></small>
      <div class="d-none name"><code>mrp_get.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Get a data product</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mrp_get</span><span class="op">(</span></span>
<span>  <span class="va">layer</span>,</span>
<span>  path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"mregions2.download_path"</span>, <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  cql_filter <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  filter <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  count <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-layer">layer<a class="anchor" aria-label="anchor" href="#arg-layer"></a></dt>
<dd><p>(character) Identifier of the data product. See <a href="mrp_list.html">mrp_list</a></p></dd>


<dt id="arg-path">path<a class="anchor" aria-label="anchor" href="#arg-path"></a></dt>
<dd><p>(character) Path to save the requests. Default is <code><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">base::tempdir()</a></code>. See details.</p></dd>


<dt id="arg-cql-filter">cql_filter<a class="anchor" aria-label="anchor" href="#arg-cql-filter"></a></dt>
<dd><p>(character) Contextual Query Language (CQL) filter. See details.</p></dd>


<dt id="arg-filter">filter<a class="anchor" aria-label="anchor" href="#arg-filter"></a></dt>
<dd><p>(character) Standard OGC filter specification. See details.</p></dd>


<dt id="arg-count">count<a class="anchor" aria-label="anchor" href="#arg-count"></a></dt>
<dd><p>(numeric) Maximum number of features to be retrieved.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An sf object with the Marine Regions data product</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function uses <a href="https://en.wikipedia.org/wiki/Web_Map_Service" class="external-link">WFS services</a> to download the
Marine Regions layers as ESRI Shapefiles.</p><div class="section">
<h3 id="caching">Caching<a class="anchor" aria-label="anchor" href="#caching"></a></h3>


<p>By default, the layers are downloaded to a temporal directory (<code><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">base::tempdir()</a></code>). You can provide
a path in the <code>path</code> argument. But you can also set a path with <code># options("mregions2.download_path" = "my/path/")</code>.</p>
<p>Because it is possible to add filters, each request is identified with a crc32 hash, provided with
<code><a href="https://rdrr.io/pkg/digest/man/digest.html" class="external-link">digest::digest()</a></code> and attached to the file downloaded.</p>
<p>Once a layer is downloaded, it will be read from the cache during the next two weeks. To avoid this, simply
delete the layers in the cache path.</p>
</div>

<div class="section">
<h3 id="filters">Filters<a class="anchor" aria-label="anchor" href="#filters"></a></h3>


<p>Both the <a href="https://portal.ogc.org/files/96288" class="external-link">Contextual Query Language (CQL) filter</a> and the <a href="https://www.ogc.org/standard/filter/" class="external-link">standard OGC filter specification</a> allow to
query the server before performing a request. This will boost performance as you will only retrieve the area of your interest. It is possible to query on attributes, but also perform
geospatial queries. For instance, you can query a bounding box of interest.</p>
<p>CQL filters are possible only in geoserver. Marine Regions uses a geoserver instance to serve its data products.
A tutorial on CQL filters is available in the <a href="https://docs.geoserver.org/stable/en/user/tutorials/cql/cql_tutorial.html" class="external-link">geoserver web site</a>.</p>
</div>

    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="mrp_list.html">mrp_list</a> to describe the list of products, <code><a href="mrp_view.html">mrp_view()</a></code> to visualize the data product in advance, <code><a href="mrp_colnames.html">mrp_colnames()</a></code> and <code><a href="mrp_col_unique.html">mrp_col_unique()</a></code> to get the name, data type and unique values of a the columns of a data product, useful to query
with the arguments <code>cql_filter</code> or <code>filter</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Set cache path</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="st">"mregions2.download_path"</span> <span class="op">=</span> <span class="st">"my/path/"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># See the list of all data products</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/View.html" class="external-link">View</a></span><span class="op">(</span><span class="va">mrp_list</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We want the Exclusive Economic Zones of Portugal. Let's first visualize the product:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="mrp_view.html">mrp_view</a></span><span class="op">(</span><span class="st">"eez"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># See all the columns on this data product</span></span></span>
<span class="r-in"><span><span class="fu"><a href="mrp_colnames.html">mrp_colnames</a></span><span class="op">(</span><span class="st">"eez"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We should query on sovereign</span></span></span>
<span class="r-in"><span><span class="co"># See all the possible values of sovereign1, sovereign2 and sovereign3</span></span></span>
<span class="r-in"><span><span class="va">sov1</span> <span class="op">=</span> <span class="fu"><a href="mrp_col_unique.html">mrp_col_unique</a></span><span class="op">(</span><span class="st">"eez"</span>, <span class="st">"sovereign1"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sov2</span> <span class="op">=</span> <span class="fu"><a href="mrp_col_unique.html">mrp_col_unique</a></span><span class="op">(</span><span class="st">"eez"</span>, <span class="st">"sovereign2"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sov3</span> <span class="op">=</span> <span class="fu"><a href="mrp_col_unique.html">mrp_col_unique</a></span><span class="op">(</span><span class="st">"eez"</span>, <span class="st">"sovereign3"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Is Portugal a value in the sovereign1, 2 and 3?</span></span></span>
<span class="r-in"><span><span class="st">"Portugal"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sov1</span></span></span>
<span class="r-in"><span><span class="co">#&gt; [1] TRUE</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="st">"Portugal"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sov2</span></span></span>
<span class="r-in"><span><span class="co">#&gt; [1] FALSE</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="st">"Portugal"</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">sov3</span></span></span>
<span class="r-in"><span><span class="co">#&gt; [1] FALSE</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Portugal is only in sovereign1. Let's write a CQL filter to get only</span></span></span>
<span class="r-in"><span><span class="co"># the EEZs of Portugal, or those where Portugal is a party of a dispute or a joint regime</span></span></span>
<span class="r-in"><span><span class="va">portugal_eez</span> <span class="op">&lt;-</span> <span class="fu">mrp_get</span><span class="op">(</span><span class="st">"eez"</span>, cql_filter <span class="op">=</span> <span class="st">"sovereign1 = 'Portugal'"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># If you perform this request again, it will be read from the cache instead</span></span></span>
<span class="r-in"><span><span class="va">portugal_eez</span> <span class="op">&lt;-</span> <span class="fu">mrp_get</span><span class="op">(</span><span class="st">"eez"</span>, cql_filter <span class="op">=</span> <span class="st">"sovereign1 = 'Portugal'"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#&gt; Cache is fresh. Reading: my/path/eez-1951c8b7/eez.shp</span></span></span>
<span class="r-in"><span><span class="co">#&gt; (Last Modified: 2023-04-24 17:45:16)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># You can also limit the number of features to be requested</span></span></span>
<span class="r-in"><span><span class="fu">mrp_get</span><span class="op">(</span><span class="st">"eez"</span>, count <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Salvador Fernandez-Bejarano, Lotte Pohl, <a href="https://lifewatch.be" class="external-link"><img src="https://www.lifewatch.be/sites/lifewatch.be/themes/lifewatchportal/images/header_lw_logo.png" width="72"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

